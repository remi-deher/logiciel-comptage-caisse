/* Fichier : public/assets/css/page-calculateur.css (Version Complète et Corrigée) */

/* --- BANDEAUX DE CLÔTURE --- */
.cloture-mode-banner, .cloture-final-summary-banner {
    margin-bottom: 25px;
    border-radius: 12px;
    padding: 20px;
    animation: fadeIn .5s;
}

.cloture-mode-banner {
    display: flex;
    align-items: center;
    gap: 20px;
    background-color: rgba(138, 43, 226, 0.1);
    color: #8a2be2;
    border: 1px solid rgba(138, 43, 226, 0.3);
}
.cloture-mode-banner i { font-size: 1.8em; }
.cloture-mode-banner div { flex-grow: 1; }
.cloture-mode-banner strong { font-size: 1.1em; display: block; }
.cloture-mode-banner p { margin: 4px 0 0; font-size: 0.9em; }

.cloture-final-summary-banner {
    background-color: rgba(39, 174, 96, 0.08);
    border: 1px solid rgba(39, 174, 96, 0.3);
}
.cloture-final-summary-banner .banner-header { text-align: center; margin-bottom: 20px; }
.cloture-final-summary-banner .banner-header h4 { border: none; margin: 0 0 5px 0; font-size: 1.5em; color: var(--color-success); }
.cloture-final-summary-banner .banner-header p { margin: 0; font-size: 1em; color: var(--color-text-secondary); }
.cloture-final-summary-banner .summary-table-container { background-color: var(--color-surface); border: 1px solid var(--color-border-light); border-radius: 8px; padding: 15px; margin-bottom: 20px; overflow-x: auto; }
.cloture-final-summary-banner .final-summary-table { width: 100%; border-collapse: collapse; }
.cloture-final-summary-banner .final-summary-table th,
.cloture-final-summary-banner .final-summary-table td { padding: 12px 15px; text-align: right; border-bottom: 1px solid var(--color-border-light); }
.cloture-final-summary-banner .final-summary-table th { background-color: var(--color-surface-alt); }
.cloture-final-summary-banner .final-summary-table th:first-child,
.cloture-final-summary-banner .final-summary-table td:first-child { text-align: left; }
.cloture-final-summary-banner .final-summary-table tfoot td { font-weight: bold; font-size: 1.1em; border-bottom: none; }
.cloture-final-summary-banner .text-danger { color: var(--color-danger); }
.cloture-final-summary-banner .text-success { color: var(--color-success); }
.cloture-final-summary-banner .banner-actions { text-align: center; }
.cloture-final-summary-banner .banner-actions .btn { padding: 12px 30px; font-size: 1.2em; font-weight: bold; }


/* --- ONGLETS DE SÉLECTION DE CAISSE --- */
.tab-selector{border-bottom:2px solid var(--color-border-light);margin-bottom:20px;display:flex;flex-wrap:wrap}
.tab-link{background-color:transparent;border:none;border-bottom:3px solid transparent;padding:12px 18px;cursor:pointer;font-size:1.1em;color:var(--color-text-secondary);transition:all .2s;font-weight:600}
.tab-link:hover{color:var(--color-primary)}
.tab-link.active{color:var(--color-primary);border-bottom-color:var(--color-primary)}
.caisse-tab-content{display:none}.caisse-tab-content.active{display:block;animation:fadeIn .5s}
.tab-link.cloture-en-cours { border-bottom-color: #8a2be2 !important; color: #8a2be2 !important; }
.tab-link.cloturee { background-color: #f0e8f9; color: #8a2be2; border-bottom-color: transparent !important; }


/* --- MODALE DE SÉLECTION DE CLÔTURE (STYLES CARTES INTERACTIVES) --- */
.modal-content.wide { max-width: 800px; }
.selection-header { display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid var(--color-border-light); }
.color-key { display: flex; flex-wrap: wrap; gap: 15px; font-size: 0.9em; }
.color-key div { display: flex; align-items: center; gap: 8px; }
.color-dot { width: 14px; height: 14px; border-radius: 50%; }
.color-dot.color-libre { background-color: var(--color-success); }
.color-dot.color-verrouillee { background-color: var(--color-warning); }
.color-dot.color-cloturee { background-color: #8a2be2; }
.caisse-selection-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 20px; margin-top: 15px; }
.caisse-selection-item { position: relative; display: block; }
.caisse-selection-item input[type="checkbox"] { display: none; }
.caisse-selection-item .caisse-info { background-color: var(--color-surface); border: 2px solid var(--color-border-light); border-left-width: 5px; border-radius: 8px; padding: 20px; transition: all 0.2s ease; display: flex; flex-direction: column; gap: 10px; height: 100%; box-sizing: border-box; cursor: pointer; }
.caisse-selection-item.status-libre .caisse-info { border-left-color: var(--color-success); }
.caisse-selection-item.status-verrouillee .caisse-info { border-left-color: var(--color-warning); }
.caisse-selection-item.status-cloturee .caisse-info { border-left-color: #8a2be2; }
.caisse-selection-item.disabled .caisse-info { opacity: 0.65; cursor: not-allowed; background-color: var(--color-surface-alt); }
.caisse-selection-item:not(.disabled) input:checked + .caisse-info { border-color: var(--color-primary); box-shadow: 0 4px 15px var(--shadow-color); transform: translateY(-5px); }
.caisse-info-header { display: flex; align-items: center; gap: 10px; font-size: 1.1em; font-weight: bold; }
.caisse-info-header i { font-size: 1.2em; }
.caisse-selection-item.status-libre .caisse-info-header i { color: var(--color-success); }
.caisse-selection-item.status-verrouillee .caisse-info-header i { color: var(--color-warning); }
.caisse-selection-item.status-cloturee .caisse-info-header i { color: #8a2be2; }
.caisse-status-text { font-size: 0.9em; color: var(--color-text-secondary); flex-grow: 1; margin: 0; }
.reopen-btn { margin-top: 10px; background-color: var(--color-surface-alt); border: 1px solid var(--color-border); color: var(--color-text-secondary); width: 100%; padding: 8px; border-radius: 6px; cursor: pointer; font-size: 0.9em; font-weight: bold; display: inline-flex; align-items: center; justify-content: center; gap: 8px; }
.reopen-btn:hover { background-color: var(--color-surface-alt-hover); }
.modal-footer .btn span.count { display: inline-block; background-color: rgba(255,255,255,0.2); border-radius: 10px; padding: 2px 8px; margin-left: 8px; font-size: 0.9em; font-weight: normal; }


/* --- STYLES RESTANTS DE LA PAGE CALCULATEUR --- */
.ecart-display-container{text-align:center;margin-bottom:20px;transition:all .3s ease;position:sticky;top:80px;z-index:99;background-color:var(--color-surface)}
.ecart-display{display:none;padding:15px;border:2px solid var(--color-border-light);border-radius:12px;transition:opacity .5s;opacity:0;background-color:var(--color-surface)}
.ecart-display.active{display:block;opacity:1}
.main-ecart-display{padding:10px;border-radius:8px;margin-bottom:10px;transition:background-color .3s,border-color .3s}.main-ecart-display .ecart-label{display:block;font-size:1em;font-weight:700;color:var(--color-text-secondary)}.main-ecart-display .ecart-value{display:block;font-size:2.2em;font-weight:700}.main-ecart-display.ecart-ok{background-color:rgba(39,174,96,.1)}.main-ecart-display.ecart-ok .ecart-value{color:var(--color-success)}.main-ecart-display.ecart-positif{background-color:rgba(243,156,18,.1)}.main-ecart-display.ecart-positif .ecart-value{color:var(--color-warning)}.main-ecart-display.ecart-negatif{background-color:rgba(192,57,43,.1)}.main-ecart-display.ecart-negatif .ecart-value{color:var(--color-danger)}
.secondary-ecarts{display:flex;justify-content:center;gap:20px;font-size:.9em}.secondary-ecart-item span{color:var(--color-text-secondary)}.secondary-ecart-item strong{font-weight:700}.secondary-ecart-item.ecart-ok strong{color:var(--color-success)}.secondary-ecart-item.ecart-positif strong{color:var(--color-warning)}.secondary-ecart-item.ecart-negatif strong{color:var(--color-danger)}
.cloture-validation-area { margin-top: 15px; padding-top: 15px; border-top: 1px dashed var(--color-border); }
.validation-message { color: var(--color-success); font-weight: bold; }
.payment-method-tabs{margin-top:20px;border:1px solid var(--color-border-light);border-radius:12px;overflow:hidden;background-color:var(--color-surface)}.payment-method-selector{display:flex;background-color:var(--color-surface-alt);padding:var(--space-sm);gap:var(--space-sm)}.payment-tab-link{flex:1;padding:12px;background-color:transparent;border:none;border-radius:8px;font-size:1em;font-weight:600;color:var(--color-text-secondary);cursor:pointer;display:flex;align-items:center;justify-content:center;gap:8px}.payment-tab-link.active{background-color:var(--color-surface);color:var(--color-primary);box-shadow:0 2px 8px rgba(0,0,0,.1)}.payment-tab-content{display:none;padding:25px}.payment-tab-content.active{display:block;animation:fadeIn .5s}@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.theoretical-inputs-panel{display:flex;gap:20px;flex-wrap:wrap;background-color:var(--color-surface-alt);padding:20px;border-radius:8px;margin-bottom:25px}.compact-input-group{flex:1 1 200px;display:flex;flex-direction:column;gap:5px}.compact-input-group label{font-size:.9em;font-weight:700;color:var(--color-text-secondary)}.compact-input-group input{font-size:1.2em;font-weight:700;padding:10px 12px;border:1px solid var(--color-border);border-radius:6px;background-color:var(--color-surface)}
.cash-drawer-section{margin-bottom:30px}
.cash-drawer-section h4{display:flex;align-items:center;gap:10px;margin-top:0;margin-bottom:15px;font-size:1.3em;padding-bottom:10px;border-bottom:2px solid var(--color-border-light);justify-content:space-between;}
.cash-drawer-section h4 .section-total { background-color: var(--color-surface-alt); padding: 5px 12px; border-radius: 20px; font-size: 0.9em; color: var(--color-primary); border: 1px solid var(--color-border-light); }
.denominations-container{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:15px}
.denom-card{background-color:var(--color-surface);border:1px solid var(--color-border-light);border-radius:8px;box-shadow:0 2px 10px var(--shadow-color);transition:transform .2s,box-shadow .2s;display:flex;flex-direction:column}
.denom-card.is-piece{background-color:var(--color-surface-alt)}
.denom-card-header{padding:10px 15px;text-align:center;font-size:1.2em;font-weight:700;border-bottom:1px solid var(--color-border-light)}
.denom-card-body{padding:15px;display:flex;align-items:center;justify-content:center;gap:10px}
.denom-card-body .quantity-input{width:60px;font-size:1.5em;text-align:center;font-weight:700;border:none;border-bottom:2px solid var(--color-border);background:0 0;border-radius:0}
.denom-card-footer{padding:10px 15px;background-color:var(--color-surface-alt);border-top:1px solid var(--color-border-light);text-align:center;font-size:1.1em;font-weight:700;color:var(--color-text-secondary)}
.totals-summary { border-top: 2px solid var(--color-border); padding-top: 20px; }
.totals-summary .summary-line{display:flex;justify-content:space-between;align-items:center;padding:12px 0;font-size:1.1em}
.totals-summary .summary-line:not(:last-child){border-bottom:1px solid var(--color-border-light)}
.totals-summary .summary-line span{font-weight:700;font-family:monospace}
.totals-summary .summary-line.grand-total{font-size:1.3em;color:var(--color-primary);padding-top:15px;margin-top:10px;border-top:2px solid var(--color-primary)}
.cheque-grid {display: grid;grid-template-columns: 1fr;gap: 25px;}
@media (min-width: 768px) {.cheque-grid {grid-template-columns: 300px 1fr;}}
.cheque-form-container {background-color: var(--color-surface);border-radius: 8px;border: 1px solid var(--color-border-light); padding: 20px;}
.tpe-table tbody tr.releve-actif { background-color: rgba(39, 174, 96, 0.1); font-weight: bold; }
.tpe-table tbody tr.releve-actif td { color: var(--color-success); }
.suggestion-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
.suggestion-table th, .suggestion-table td { padding: 12px 15px; border-bottom: 1px solid var(--color-border-light); text-align: right; }
.suggestion-table th { background-color: var(--color-surface-alt); font-weight: 600; color: var(--color-text-secondary); }
.suggestion-table th:first-child, .suggestion-table td:first-child { text-align: left; }
.suggestion-total { margin-top: 20px; padding-top: 15px; border-top: 2px solid var(--color-primary); text-align: right; font-size: 1.2em; font-weight: bold; }
.suggestion-total span { color: var(--color-primary); }


/* --- STYLES POUR LES ÉTATS DE CLÔTURE --- */
.tab-link.cloture-en-cours {
    border-bottom-color: #8a2be2 !important; /* Violet */
    color: #8a2be2 !important;
    background-color: rgba(138, 43, 226, 0.05);
}

.tab-link.cloturee {
    background-color: #f0f0f0;
    color: #95a5a6;
    border-bottom-color: transparent !important;
    cursor: not-allowed;
}

body[data-theme="dark"] .tab-link.cloturee {
    background-color: var(--color-surface-alt);
}

.cloture-validation-area {
    margin-top: 15px;
    padding: 15px;
    border-top: 1px dashed var(--color-border);
    background-color: var(--color-surface-alt);
    border-radius: 8px;
    text-align: center;
}

.cloture-validation-area p {
    margin: 0 0 10px 0;
    font-weight: bold;
    color: var(--color-text-secondary);
}

.cloture-validation-area .validation-message {
    color: var(--color-success);
}

.tab-link.status-locked-by-me {
    color: #8a2be2 !important; /* Violet */
    font-weight: bold;
}

/* Style pour l'encart des écarts en mode clôture */
.ecart-display.cloture-mode {
    background-color: rgba(138, 43, 226, 0.05); /* Fond violet très clair */
    border: 2px solid rgba(138, 43, 226, 0.4); /* Bordure violette */
}

/* Conteneur pour la section des retraits qui apparaît sous les écarts */
#cloture-details-container {
    margin-top: -10px; /* Pour se coller joliment sous l'encart des écarts */
    margin-bottom: 25px;
    padding: 20px;
    border: 2px solid rgba(138, 43, 226, 0.4);
    border-top: none;
    border-radius: 0 0 12px 12px;
    background-color: rgba(138, 43, 226, 0.02);
    animation: fadeIn 0.5s;
}

.cloture-actions {
    display: flex;
    justify-content: flex-end;
    gap: 15px;
    margin-top: 20px;
}

/* On s'assure que le statut "verrouillé par un autre" est clair sur l'onglet */
.tab-link.status-locked-by-other {
    color: #f39c12 !important; /* Orange */
    cursor: not-allowed;
}

/* On s'assure que le statut "clôturé" est clair sur l'onglet */
.tab-link.status-closed {
    color: #27ae60 !important; /* Vert */
    background-color: rgba(39, 174, 96, 0.05);
    cursor: not-allowed;
}
